[TOC]

# 直接使用文件名引用文件，而不使用路径引用
在该文件开头加入

```javascript
/**
 * @providesModulePromptLabel
 */
 class MyClass {
 }
```
引用
```javascript
import MyClass from 'MyClass' 
```

# ListView 标签流式布局

```
contentContainerStyle={styles.listContainer}
listContainer:{
flexDirection:'row',
flexWrap:'wrap',
},

```
**这种方式只能实现类似标签的高度相等，宽度不同的布局，不能实现高度不同，宽度相同的瀑布流布局**
row的最外层需要设置确定的高度

# ListView 瀑布流

row设置为绝对布局，计算位置

# renderRow执行的次数比dataSource的数量少
如果出现renderRow执行的次数比dataSource的数量少的情况，  
需要设置:  
`initialListSize={20} // 可以把值改为dataSource的length`  
如果不设置,renderRow只能执行前几条数据, 想显示其他数据, 只能通过改变任意state来实现


# 下拉图片放大

先举个例子，你可能希望你的Animated.Value从0变化到1时，把组件的位置从150px移动到0px，不透明度从0到1。可以通过以下的方法修改style属性来实现：

```javascript
 style={{
   opacity: this.state.fadeAnim, // Binds directly
   transform: [{
     translateY: this.state.fadeAnim.interpolate({
       inputRange: [0, 1],
       outputRange: [150, 0]  // 0 : 150, 0.5 : 75, 1 : 0
     }),
   }],
 }}>
```

```javascript
'use strict';

import React from 'react'
import ReactNative, {
  View,
  ListView,
  StyleSheet,
  TouchableOpacity,
  Image,
  Text,
  Dimensions,
  Animated
} from 'react-native'

const resValue = require('../css/resValue');
import * as globalStyles from '../css/globalStyles';
import images from '../image/images'
import * as UserService from '../proxy/UserService'
import LoadingView from './LoadingView'
import NormalTitleRow from './NormalTitleRow'
import CertificateView from './CertificateView'

const IMG_HEIGHT = 300 / 2 + 10

export default class MentorInfoHeaderView extends React.Component {
  
  constructor(props) {
    super(props);
    
    this.state = {
    yOffset: 0,
      
    anim: new Animated.Value(0)
    }
  }
  
  render() {
    const { yOffset } = this.props
    
    if (yOffset < 0) {
      var imgScale = (-yOffset + IMG_HEIGHT) / IMG_HEIGHT
      var scale = this.state.anim.interpolate({
      inputRange: [-1, 0],
      outputRange: [0, imgScale],
      extrapolate: 'clamp',
      })
      
      var y = (-yOffset / 2) / imgScale
      var translateY = this.state.anim.interpolate({
      inputRange: [-1, 0],
      outputRange: [0, y],
      extrapolate: 'clamp',
      })
    } else {
      var scale = this.state.anim.interpolate({
      inputRange: [-1, 0],
      outputRange: [0, 1],
      extrapolate: 'clamp',
      })
      var translateY = this.state.anim.interpolate({
      inputRange: [-1, 0],
      outputRange: [0, -yOffset],
      extrapolate: 'clamp',
      })
    }
    
    return (
    	<Animated.Image
    		source={images.Myinfo.HEAD_BACKGROUND_STAR}
    		style={[
    			styles.backgroundImage, 
    			this.props.style, 
    			{transform: [{scale}, {translateY}]}
    		]}
    	/>
     )
  }
}

var styles = StyleSheet.create({
	backgroundImage: {
		height: IMG_HEIGHT,
	},
})
```

# 得到text的高度

```javascript
<Text onLayout={(event)=>this._textOnLayout(event)} />

_textOnLayout(event){
	console.log(event.nativeEvent.layout.height,'onLayout');
}
```

# ListView从下向上排列

```javascript
<ListView contentContainerStyle={styles.listViewContent}/>
listViewContent:{
	flex:1,
	//从下向上排列
	justifyContent:'flex-end'
}
```

# 得到组件宽高

```javascript
this.refs.row.measure(function(ox,oy,width,height,px,py){
	cellHeight=height;
});

<View style={styles.row}ref="row"/>

row:{
	flex:1,
	backgroundColor:'#FFFFFF',
	borderTopWidth:1/2,
	borderBottomWidth:1/2,
	borderColor:'#dddddd',
	marginTop:10/2,
	marginBottom:10/2
},
```

# 指定某个组件

```javascript
var _listView: ListView;
<ListView ref={(listView)=>{_listView=listView;}}/>
```

# 版本更新
```javascript
openAppStore: ()=> {
  var url = '';
  if (Platform.OS === 'ios') {
    url = 'itms-apps://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&onlyLatestVersion=true&pageNumber=0&sortOrdering=1&id=1156814163';
  } else {
    url = 'http://a.app.qq.com/o/simple.jsp?pkgname=com.girtu.girtu'
  }

  Linking.openURL(url).catch(err => console.error('An error occurred', err));
},

checkoutUpdate: ()=> {
  let setLaterUpdateTime = (time) => {
    AsyncStorage.setItem('update_time', time);
  }

  let getLaterUpdateTime = () => {
    return AsyncStorage.getItem('update_time')
  }

  // 点击了稍后更新, 保存当前时间
  let laterUpdate = ()=> {
    setLaterUpdateTime(new Date().toString())
  }

  // 点击立即下载只是跳转到商店,本地不做处理,如果没有更新,下次进入依然提醒
  // 点击稍后下载,本地记录时间,10天后再次提醒
  let showAlert = ()=> {
    Alert.alert('有新版本发布, 是否更新', '', [
      {text: '马上下载', onPress: ()=>module.exports.openAppStore()},
      {text: '稍后更新', onPress: ()=>laterUpdate()}
    ])
  }

  // 计算时间差, 如果大于10天就显示alert, 否则什么都不做
  let calculateDateDiff = (oldDate)=> {
    oldDate = new Date(oldDate)
    let newDate = new Date(); //结束时间
    let differDate = newDate.getTime() - oldDate.getTime(); //时间差的毫秒数
    let days = Math.floor(differDate / (24 * 3600 * 1000)); ////计算出相差天数
    if(days >= 10) {
      showAlert()
    }
  }

  setTimeout(()=> {
    // 假设获取到版本号后
    let newVersion = '2.3.3';
    let oldVersion = DeviceInfo.getVersion();
    if (newVersion > oldVersion) {
      getLaterUpdateTime()
        .then((oldDate)=> {
          // 如果有时间就计算时间差, 没有时间就直接显示
          if (oldDate) {
            calculateDateDiff(oldDate)
            // calculateDateDiff(1489075200000)
          } else {
            showAlert()
          }
        })
        .catch((e)=> {
          showAlert()
        })
    }
  }, 2000)
},
```

