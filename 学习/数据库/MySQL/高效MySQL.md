---
title: 高效MySQL
---

[TOC]

## MySQL优化的关键
### 应用访问的优化
因为有应用需要访问我们的数据库，有请求的发送、数据的存储和网络的交互等等，会导致数据库性能发生比较慢的地方

1. 减少数据的访问。因为减少数据的访问其实就是减少磁盘的访问。
    我们知道数据访问磁盘获得数据的速度很慢，如果我们是器械磁盘，因为器械磁盘是通过器械旋转来获得数据。
    我们应该把活跃数据和内存数据放在内存里面，这样可以使我们的数据库性能提升 1-1000 倍，它的优化成本很低。
    
2. 减少返回更多的数据，减少返回更多的数据终结就是减少了网络的传输，有很多大的系统，网络传输是一个很重要的瓶颈。
    假设我们的数据库服务器跟我们应用服务器的距离是 20 公里的话，因为光线数据库是 20 公里，一个光的请求是 0.2 毫秒。如果我们减少更少的数据请求的话，那这个时间就会变短很多。
    所以说如果我们发现数据库的性能有问题，我们可以去看是否网络上存在问题或者是通过 P 命令看时间是否会变得长。
    
3. 减少交互次数，每个交互假设还是按照 20 公里来说，一个交互的时间就是 0.2 毫秒，2 个交互就是 0.4 毫秒。如果有 1 万个操作的话，就是 1 万乘 0.4 毫秒，那就变得整个交互时间变短了很多。

### 数据库实例的优化
![](media/15337000198404.jpg)

### SQL语句的优化
- 尽量用单表查询，禁止多于3表的join
- 禁止使用select * from语句，尽量只获取需要的字段
- 避免多余的排序
- 全模糊查询无法使用索引，应尽可能避免
- 使用in代替or
- 禁止隐式转换
- 禁止使用负项查询，例如not in、!=、not like
- 尽量用union all代替union
- 尽量早过滤
- 尽量避免使用count(*)的操作

## 索引的设计
![](media/15337001754232.jpg)
这里说的是覆盖索引，比如说有了这个覆盖索引我们的查询，查询的字段都是在这个索引内。

还有我们查询的后面的字段也是索引，然后还有我们一些排序位置也是覆盖索引，就是这一系列全部都是中了索引的情况所以就叫覆盖索引。

这里我也列举了一些不能使用索引的情况：比如说不要给选择率低的字段选择索引，如果通过索引扫描记录数超过 30% 就变成全表扫描了。

还有 Like 额查询条件列最左以通配符 % 开始，两个独立索引，其中一个用于索引一个用于排序。以上就是对于 MySQL 性能优化的步骤。
                      