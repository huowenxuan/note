
## 12.8 
### 0.0-0.39 
mm note首页使用css支持显示多行note并且控制最多显示5行，markdown页转换为原始文字后显示换行，不再需要自己转换换行符了

### -10.13 
mm nav title加入padding-top，修改状态栏颜色，需要添加cordova-plugin-statusbar插件

### -11.9 
修改软件说明书

### -12.5 
解决微信登陆后获取不到用户的bug，是我粗心了，改了登陆的代码结构后少调用一层，应该用token.token，而不是直接用token

### 14.0-16.40 
开会

### 13.0-18.40 
## iOS通用链接
配置通用链接成功！可以在微信和QQ中打开鹿小圈了，访问[https://www.luxiaoquan.com/applinks/](https://www.luxiaoquan.com/applinks/)即可（秒拍也是/applinks/，所以昨天的猜想没错）
首先要有支持SSL的域名

### 步骤
1. 开发者中心配置：App IDs->打开Associated Domains->Done
2. 在服务器根目录放json文件去掉json后缀的`apple-app-site-association`文件，details为teamId/Prefix.appId，paths为*代表可访问所有链接，为applinks

    ```
{
  "applinks": {
    "apps": [],
    "details": [{
      "appID": "PQB7M5XKY8.com.luxiaoquan.www",
      "paths": ["/applinks/"]
    }]
  }
}
    ```

3. 在项目中targets->Capabilities->Associated Domains打开，添加Domains为支持ssl的域名`applinks:www.luxiaoquan.com`、`applinks:luxiaoquan.com`...，applinks是固定的，必须加。然后在**安装**app时就会自动访问域名下的apple-app-site-association文件，并且下载到手机中

### 跳转方式
1. 在记事本、备忘录、短信中长按链接弹出ActionSheet，成功就会出现“在鹿小圈中打开”的选项
2. 通过链接跳转到https://www.luxiaoquan.com/applinks/（直接从浏览器输入不行）

### 支持情况（多次测试两部iPhone）：
* 微信/QQ/手机百度/UC/Chrome/Firfox中可以直接打开app不跳转到applinks/
* 在夸克浏览器/QQ浏览器中只是跳转到applinks/无法打开app，
* 在Safari中，如果之前从未通过Safari打开，会先跳转到applinks/，然后下拉网页就会出现打开鹿小圈（效果可查看秒拍[http://m.miaopai.com/show/channel/uF-pF2oYiXvs5tYEJ1T0TA__](http://m.miaopai.com/show/channel/uF-pF2oYiXvs5tYEJ1T0TA__)，点击上方的打开），此时打开之后，下次再进入applinks/就会直接打开app。如果之前从微信打开app，Safari第一次也会直接打开app。
* 如果未安装，所有的浏览器都会直接跳转到applinks/网页

### 最终方案
* iOS：点击打开之后跳转到www.luxiaoquan.com/applinks/，指向applinks.html，如果安装了app就会直接打开，否则会跳转到applinks.html。html上方提示如果安装了鹿小圈，下拉可打开；中间有一个大的下载按钮，点击后跳转到应用宝微下载。
* Android：点击打开之后，如果是微信或者QQ，弹出模态提示从浏览器打开；其他情况先尝试打开app，再延迟1秒跳转到微下载，和applinks无关了

网页中打开按钮的onclick事件完成，区分iOS安卓，安卓中区分微信QQ，剩下的就是简单铺applinks.html页面和修改微下载链接

## 12.7 
### -0.3 
mm
note列表、编辑、markdown加入start作为开始时间，把time字段改为end作为结束时间。

> 因为ion-datetime必须有默认值才能转换为北京时间，所以用checkbox控制是否添加start，而start是永远存在的

### -11.55 
创建本地node服务器，让手机访问本地网页，开发网页的深度链接。安卓完成通过网页的链接打开APP并且获取到参数
安卓需要设置<category android:name="android.intent.category.BROWSABLE"/>支持通过浏览器打开APP，在MainActivity中判断是推送还是deeplink分别处理。

### -14.29 
iOS处理深度链接的url，只需要使用RN的Linking即可，不需要自己在原生做处理，都在JS处理。把点击推送的处理方法教给App.js来配置，深度链接类似，他们使用同一个方法来处理

### -14.51 
android也使用Linking处理深度链接，不需要在原生处理了，只需要在manifest中声明scheme、host、path，activity添加`android:launchMode="singleTask"`即可。也不需要在MainActivity中判断了，统一交给JS处理

### -15.14 
使用[urijs](https://github.com/medialize/URI.js)解析deeplink

### -15.48 
app处理深度链接完成，也兼容推送

url参数：

* type: board topic event
* boardId: 必须。type不管是不是board，都会直接进入圈子，如果是成员就进入圈子；不是成员就去圈子公开页面，下面的参数都无效
* eventId: type=event && eventId 就会进入圈子，然后进入活动详情
* topicId: type=topic && topicId 就会进入圈子，然后进入话题详情

### -18.56 
调研web端判断app是否安装，无法判断，尤其是在iOS9之后，查看简书和秒拍的网页js代码，简书是一边打开app，一边跳转到应用宝下载页面，秒拍是同时显示打开app和下载，大多数方案和简书一样。

查看[OpenInstall](http://www.openinstall.io/)`app个性化安装`，安卓、iOS、Web都支持，一年8000，放弃

iOS：

* Safari 可以打开app
* 第三方浏览器：无法打开

Android：

° 所有浏览器都可以打开

微信和QQ：拦截了通过scheme打开app，可以通过微下载来跳到appstore，但是相当于放弃了直接打开app，通用的办法是让用户从Safari打开，但是秒拍、今日头条等在iOS的微信可以直接打开app，在android打不开，所以不是白名单的原因，根据[http://blog.csdn.net/henrywulibin/article/details/52087041](http://blog.csdn.net/henrywulibin/article/details/52087041)的说法，是使用了iOS9的`Universal links`，可以通过http协议打开app，需要app支持，还要继续研究，现在先从Safari打开。

所以暂时的方案是：微信和QQ在iOS中提示Safari打开，安卓提示浏览器打开，其他的浏览器都是先尝试打开app，再延迟一秒打开微下载链接。继续研究Universal links

## 12.6 
### -11.0 
解决iOS微信登录失败的问题，根据[http://bbs.mob.com/thread-23989-1-1.html](http://bbs.mob.com/thread-23989-1-1.html)的提示，
`检查看看您在-(BOOL)applicationUIApplication *)app openURLNSURL *)url optionsNSDictionary<NSString *,id> *)options 这个方法中是不是做 了什么处理，又调用了一次系统接口，这个错误通常是多次调用 openURL方法，导致重复使用，或是 您自行获取过code，然后使用了 我们SDK之后也进行了相关操作，可能会导致`


### -15.30 
查找微信登录后Not Found user的错误原因

### -16.19 
mm：解决指令引入重复的bug，把所有的page、directive、component都移动到AppModule中，push时使用类push，而不是类名，否则会报page重复引用的错误，不知如何解决

### -17.27 
研究android的deeplink，也是通过schemes打开，调研网页判断app是否安装和打开app的方法。

还需要确定跳转后的动作

## 12.5 
### -11.53 
微信登陆第一次会成功，以后一两分钟内再登陆会失败，提示code已经用过，找不到错误

mm
模仿imoji代码，使用指令实现监听键盘，成功，之前用的组件使用固定高度，还需要美化UI

### -15.40 
mm 
模仿imoji的聊天输入框重新做，为了让多行文字时左右两个按钮垂直居中或者居下（居下更好），实现方式从ion-grid改为ion-toolbar。输入框外面套了一个ion-item导致下方有10像素左右的空白搞了半天，去掉ion-item就好了，还需要优化一下间距

### -16.4 
使用新的微信开放平台，会导致老用户微信登录时候所有信息不存在，需要绑定手机号才能把账号迁移过来，所以在微信登录后发现没有手机，就直接跳转到绑定手机号页，重新整理这部分代码，把每个错误信息都使用toast显示出来，当用户登录失败时可以更好的帮我们解决问题，

### -19.14 
mm
主页复制图标改为日历图标更贴切；
进一步处理聊天输入框，UI算完成了，ion-toolbar套在ion-footer中在iOS高度很高，看了两个小时没解决，更新ionic版本解决！！！

## 12.4 

### -10.33 
搭建python3，安装pip3，初始化python爬虫项目

### -16.39 
研究微信公众号历史消息的爬取，有两个参数是在客户端生成的，所以只能在服务器运行安卓模拟器，使用adb控制。而且有人说在模拟器登陆很容易永久封号。

### -18.4 
api改为新的域名
图片改为新的域名
网页分享改为新的域名
微信appid和小程序改为新的
无网络连接的提示完成，区分iOS安卓，模仿喜马拉雅
微信登陆后台暂时报错无法登陆，其它正常，图片还需要兼容旧的域名

### -18.58 
mm

* markdown页的每日日程倒序，日期不变
* 修复日期选择时取消发生错误的bug
* markdown页增加一些换行

## 12.01
#### -16.36
pa支持npm导入；导出方法；整理、抽取代码，优化错误处理
#### -18.23
判断网络状态，使用Overlay从下方弹出提示文字，点击去提示界面
为了同时支持登录、圈子列表、话题。不能现在在导航栏下方，所以显示在全局上方




