------

## 8.3 
### -11.33 
完善poi表，加入type，为吃、住、行、游、娱、购，去掉marker表，景点也可以算poi

参考高德地图返回的poi数据，新建ad表，每个省市区都有一个唯一的adcode，为6位，每两位分别代表省市区

poi、目的地、景区都有一个adcode表示位置，address表示详细位置，lat、lon表示中心点的坐标，不需要在每个表中再保存省市区了，而且可以使用省市区表做其他的事，将来做国际化也会方便很多。



### -15.46 
考虑到一个场景：景点或者poi的排序，手动排序可建一个关联表，保存order字段，当A插入到B和C中间时，A的order=B+(C-B)/2。但实际上他们是可以按热度排序的，热度通过点击数、评论数等综合计算出来的值。将来做推荐或者置顶时，可以再单独建一个表

### -18.57 
查找高德地图的adcode列表，完全可以做成一个数组，不需要保存在数据库中

国家有国家统计局统计用区划和城乡划分代码，共12位，高德的adcode的自创的

爬取国家统计局的数据，对这些数据进行处理，只精确到街道，去掉无用的参数，增加level为1-3，增加type参数，为province、city、district，合并成一个json。统计局的数据中不包含港澳台，市也只有343个


------

## 8.1 
### -11.0 
使用egg-passport-jwt进行鉴权，可生成与验证token，把jwt当做中间件，在路由中加上就可以，在app.js中统一verify

### -14.13 
将鉴权与用户service连接起来

回顾一些mysql的知识，重新引入mysql，删掉无用的mongo、passport库

### -18.27 
使用koa-joi-swagger集成swagger，使用中间的方式实现，可用js代码生成api文档网页，直接访问/swagger就可以看到接口文档（不能和现有路由重复，会替换掉），可以生成restful api的文档，腾讯的joi使用链式语法来定义每个api的规则，相比json格式显得更简洁

egg-swagger、egg-swagger-ui、egg-apidoc都在gihub中被删掉了，不再维护，找到了使用egg的demo，使用swagger，学习他的代码集成进来

对比swager和apidoc，还是选择了swagger，用的人多，而且apidoc是在定义路由的代码上写文档，造成文档比代码行数还多的现象，代码太乱，swagger可以单靠一个js文件来写文档，自动生成网页版的文档

